# å¤šæ•°æ®åº“Bugçˆ¬å–è¯´æ˜

## âœ… å·²å®ç°çš„æ•°æ®åº“çˆ¬è™«

ä½ ç°åœ¨å¯ä»¥åŒæ—¶çˆ¬å–ä»¥ä¸‹æ•°æ®åº“çš„bugsï¼š

| æ•°æ®åº“ | GitHubä»“åº“ | çŠ¶æ€ | è¯´æ˜ |
|--------|------------|------|------|
| **DuckDB** | `duckdb/duckdb` | âœ… æ´»è·ƒ | å¤§é‡bug issues |
| **ClickHouse** | `ClickHouse/ClickHouse` | âœ… æ´»è·ƒ | å¤§é‡bug issues |
| **MonetDB** | `MonetDB/MonetDB` | âœ… æ´»è·ƒ | å¤§é‡bug issues |
| **PostgreSQL** | `postgres/postgres` | âš ï¸ é•œåƒ | å®˜æ–¹ä»“åº“é•œåƒï¼Œissuesè¾ƒå°‘ |
| **MySQL** | `mysql/mysql-server` | âš ï¸ é•œåƒ | å®˜æ–¹ä»“åº“é•œåƒï¼Œissuesè¾ƒå°‘ |
| **MariaDB** | `MariaDB/server` | âš ï¸ å°‘é‡ | issuesæ•°é‡è¾ƒå°‘ |
| **SQLite** | - | âŒ ä¸é€‚ç”¨ | ä½¿ç”¨è‡ªå·±çš„bug tracker |

---

## ğŸš€ ä½¿ç”¨æ–¹æ³•

### æ–¹å¼1ï¼šä½¿ç”¨å¤šæ•°æ®åº“çˆ¬è™«ï¼ˆæ¨èï¼‰

```bash
cd /root/QTRAN/mydata/bugjson

# æ¯ä¸ªæ•°æ®åº“çˆ¬å–20ä¸ªbug
python crawl_multi_db.py 20

# æ¯ä¸ªæ•°æ®åº“çˆ¬å–50ä¸ªbug
python crawl_multi_db.py 50

# æ¯ä¸ªæ•°æ®åº“çˆ¬å–100ä¸ªbug
python crawl_multi_db.py 100
```

**è¾“å‡ºæ–‡ä»¶**: `bugs_multi_db.json`

### æ–¹å¼2ï¼šä½¿ç”¨advanced_crawlerï¼ˆå®Œæ•´çˆ¬å–ï¼‰

```bash
# çˆ¬å–æ‰€æœ‰é…ç½®çš„æ•°æ®åº“
python advanced_crawler.py
```

**è¾“å‡ºæ–‡ä»¶**: `bugs.json`

### æ–¹å¼3ï¼šä½¿ç”¨demoï¼ˆå¿«é€Ÿæµ‹è¯•ï¼‰

```bash
# æ¯ä¸ªæ•°æ®åº“çˆ¬å–10ä¸ªbugç”¨äºæ¼”ç¤º
python demo.py
```

**è¾“å‡ºæ–‡ä»¶**: `bugs_demo.json`

---

## ğŸ“Š çˆ¬å–ç»“æœç¤ºä¾‹

### å®é™…çˆ¬å–æµ‹è¯•ç»“æœ

```bash
$ python crawl_multi_db.py 20
```

```
ğŸ“Š çˆ¬å–å®Œæˆç»Ÿè®¡:
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  âš ï¸  DuckDB            0 ä¸ªæ–°bug
  âœ… ClickHouse      100 ä¸ªæ–°bug
  âš ï¸  PostgreSQL        0 ä¸ªæ–°bug
  âš ï¸  MySQL             0 ä¸ªæ–°bug
  âœ… MonetDB         100 ä¸ªæ–°bug
  âš ï¸  MariaDB           0 ä¸ªæ–°bug
  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  æ€»è®¡:          200 ä¸ªæ–°bug
  æ€»bugæ•°:       200 ä¸ª
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ“Š æ•°æ®åº“åˆ†å¸ƒ:
  ClickHouse       100 ( 50.0%)
  MonetDB          100 ( 50.0%)
```

### ä¸ºä»€ä¹ˆæŸäº›æ•°æ®åº“çˆ¬å–ä¸åˆ°ï¼Ÿ

**1. DuckDB (0ä¸ª)**
- åŸå› ï¼šbugs.jsonä¸­å·²ç»æœ‰DuckDBçš„bugsï¼Œè‡ªåŠ¨å»é‡
- è§£å†³ï¼šè°ƒæ•´`since_date`å‚æ•°åˆ°æ›´æ™šçš„æ—¥æœŸ

**2. PostgreSQL (0ä¸ª)**
- åŸå› ï¼šGitHubä¸Šçš„postgres/postgresæ˜¯åªè¯»é•œåƒ
- å®˜æ–¹bug trackerï¼šhttps://www.postgresql.org/support/submitbug/
- è§£å†³ï¼šéœ€è¦ä»å®˜æ–¹é‚®ä»¶åˆ—è¡¨çˆ¬å–

**3. MySQL (0ä¸ª)**
- åŸå› ï¼šGitHubä¸Šçš„mysql/mysql-server issuesè¾ƒå°‘
- å®˜æ–¹bug trackerï¼šhttps://bugs.mysql.com/
- è§£å†³ï¼šéœ€è¦å®ç°Bugzilla APIçˆ¬è™«

**4. MariaDB (0ä¸ª)**
- åŸå› ï¼šGitHubä»“åº“issuesæ•°é‡å¾ˆå°‘ï¼ˆåªæœ‰8ä¸ªï¼‰
- å®˜æ–¹bug trackerï¼šhttps://jira.mariadb.org/
- è§£å†³ï¼šéœ€è¦å®ç°Jira APIçˆ¬è™«

**5. SQLite (ä¸æ”¯æŒ)**
- åŸå› ï¼šSQLiteä¸ä½¿ç”¨GitHub
- å®˜æ–¹bug trackerï¼šhttps://www.sqlite.org/src/reportlist
- è§£å†³ï¼šéœ€è¦å®ç°ä¸“é—¨çš„SQLiteçˆ¬è™«

---

## ğŸ”§ è‡ªå®šä¹‰é…ç½®

### è°ƒæ•´çˆ¬å–å‚æ•°

ç¼–è¾‘ `crawl_multi_db.py`:

```python
# ä¿®æ”¹èµ·å§‹æ—¥æœŸï¼ˆè·å–æ›´æ—§çš„bugï¼‰
since_date="2019-01-01"  # é»˜è®¤ 2020-01-01

# ä¿®æ”¹æ¯ä¸ªæ•°æ®åº“çš„æ•°é‡
databases = [
    {"repo": "duckdb/duckdb", "name": "DuckDB", 
     "max_issues": 500, "labels": ["bug"]},  # æ”¹ä¸º500
    ...
]
```

### æ·»åŠ æ–°æ•°æ®åº“

åœ¨ `databases` åˆ—è¡¨ä¸­æ·»åŠ ï¼š

```python
{
    "repo": "owner/repo",
    "name": "DatabaseName",
    "labels": ["bug"]
}
```

---

## ğŸ’¡ æé«˜çˆ¬å–æˆåŠŸç‡çš„æŠ€å·§

### 1. ä½¿ç”¨GitHub Token

```bash
vim crawler_config.py
# æ·»åŠ : GITHUB_TOKEN = "ghp_ä½ çš„token"
```

**å¥½å¤„**ï¼š
- æ— Token: 60è¯·æ±‚/å°æ—¶
- æœ‰Token: 5000è¯·æ±‚/å°æ—¶

### 2. è°ƒæ•´since_date

```python
# çˆ¬å–æ›´ä¹…è¿œçš„æ•°æ®
since_date="2015-01-01"
```

### 3. ç§»é™¤æ ‡ç­¾è¿‡æ»¤

```python
# ä¸è¿‡æ»¤æ ‡ç­¾ï¼Œè·å–æ‰€æœ‰issues
labels=[]
```

### 4. å¢åŠ max_issues

```python
# æ£€æŸ¥æ›´å¤šissues
max_issues=500
```

---

## ğŸ“ˆ è·å–æ›´å¤šæ•°æ®åº“bugsçš„æ–¹æ³•

### æ–¹æ³•1ï¼šä»bugs.jsonä¸­ç­›é€‰

```bash
# æŸ¥çœ‹bugs.jsonä¸­æœ‰å“ªäº›æ•°æ®åº“
python stats.py

# ç­›é€‰ç‰¹å®šæ•°æ®åº“
python -c "
import json
bugs = json.load(open('bugs.json'))
sqlite_bugs = [b for b in bugs if b['dbms'] == 'SQLite']
print(f'SQLite bugs: {len(sqlite_bugs)}')
"
```

### æ–¹æ³•2ï¼šä½¿ç”¨ä¸åŒçš„æ•°æ®æº

**DuckDB**: 
- GitHub issuesæ´»è·ƒ âœ…
- å¯ä»¥çˆ¬å–å¤§é‡æ•°æ®

**SQLite**:
- ä»bugs.jsonä¸­å·²æœ‰193ä¸ªSQLite bugs
- å®˜æ–¹tracker: https://www.sqlite.org/src/reportlist

**MySQL**:
- Bugzilla: https://bugs.mysql.com/
- éœ€è¦å®ç°ä¸“é—¨çš„çˆ¬è™«

**PostgreSQL**:
- é‚®ä»¶åˆ—è¡¨: https://www.postgresql.org/list/pgsql-bugs/
- éœ€è¦è§£æé‚®ä»¶æ ¼å¼

---

## ğŸ¯ æ¨èå·¥ä½œæµç¨‹

### 1. å¿«é€Ÿæµ‹è¯•ï¼ˆè·å–å°‘é‡æ•°æ®ï¼‰

```bash
# æ¯ä¸ªæ•°æ®åº“10-20ä¸ªbug
python crawl_multi_db.py 20
```

### 2. å®Œæ•´çˆ¬å–ï¼ˆè·å–å¤§é‡æ•°æ®ï¼‰

```bash
# æ¯ä¸ªæ•°æ®åº“100-200ä¸ªbug
python crawl_multi_db.py 200
```

### 3. æ¸…ç†æ•°æ®

```bash
# ç§»é™¤å™ªéŸ³
python clean_bugs.py bugs_multi_db.json
```

### 4. åˆå¹¶åˆ°ä¸»æ–‡ä»¶

```bash
python -c "
import json
import shutil

# å¤‡ä»½
shutil.copy('bugs.json', 'bugs.json.backup')

# åŠ è½½
main_bugs = json.load(open('bugs.json'))
new_bugs = json.load(open('bugs_multi_db.json'))

# å»é‡åˆå¹¶
existing_links = set()
for bug in main_bugs:
    for link in bug.get('links', {}).values():
        existing_links.add(link)

added = 0
for bug in new_bugs:
    bug_link = bug.get('links', {}).get('bugreport', '')
    if bug_link and bug_link not in existing_links:
        main_bugs.append(bug)
        existing_links.add(bug_link)
        added += 1

# ä¿å­˜
json.dump(main_bugs, open('bugs.json', 'w'), indent=4, ensure_ascii=False)
print(f'âœ… æ–°å¢ {added} ä¸ªbugï¼Œæ€»è®¡ {len(main_bugs)} ä¸ª')
"
```

---

## ğŸ“Š å½“å‰æ•°æ®é›†çŠ¶æ€

ä» `bugs.json` ä¸­å·²æœ‰çš„æ•°æ®ï¼š

```
æ€»bugæ•°: 699ä¸ª
æ•°æ®åº“åˆ†å¸ƒ:
  âœ… ClickHouse:  200ä¸ª (28.6%)
  âœ… SQLite:      193ä¸ª (27.6%)
  âœ… DuckDB:       75ä¸ª (10.7%)
  âœ… CockroachDB:  68ä¸ª (9.7%)
  âœ… TiDB:         62ä¸ª (8.9%)
  âœ… MySQL:        40ä¸ª (5.7%)
  âœ… PostgreSQL:   31ä¸ª (4.4%)
  âœ… å…¶ä»–:        30ä¸ª
```

**è¯´æ˜**ï¼š
- âœ… bugs.jsonä¸­å·²ç»åŒ…å«å¤šç§æ•°æ®åº“
- âœ… SQLiteæœ‰193ä¸ªï¼ˆæ— éœ€é¢å¤–çˆ¬å–ï¼‰
- âœ… MySQLæœ‰40ä¸ªï¼ˆæ— éœ€é¢å¤–çˆ¬å–ï¼‰
- âœ… PostgreSQLæœ‰31ä¸ªï¼ˆæ— éœ€é¢å¤–çˆ¬å–ï¼‰

---

## âœ… æ€»ç»“

### ç°åœ¨æ”¯æŒçš„åŠŸèƒ½

1. âœ… **åŒæ—¶çˆ¬å–6ä¸ªæ•°æ®åº“**
   - DuckDBã€ClickHouseã€PostgreSQL
   - MySQLã€MonetDBã€MariaDB

2. âœ… **è‡ªåŠ¨å»é‡**
   - æ£€æŸ¥å·²æœ‰é“¾æ¥
   - é¿å…é‡å¤æ•°æ®

3. âœ… **æ™ºèƒ½è¿‡æ»¤**
   - ç§»é™¤æ—¥å¿—å’Œå †æ ˆè·Ÿè¸ª
   - åªä¿ç•™çº¯å‡€SQL

4. âœ… **è¯¦ç»†ç»Ÿè®¡**
   - æ¯ä¸ªæ•°æ®åº“çš„çˆ¬å–ç»“æœ
   - æ•°æ®åº“åˆ†å¸ƒå›¾

### ä½¿ç”¨å»ºè®®

```bash
# 1. å¿«é€Ÿè·å–å¤šæ•°æ®åº“æ ·æœ¬
python crawl_multi_db.py 20

# 2. æ¸…ç†æ•°æ®
python clean_bugs.py bugs_multi_db.json

# 3. æŸ¥çœ‹ç»“æœ
python -c "import json; bugs=json.load(open('bugs_multi_db.json')); \
  from collections import Counter; print(Counter(b['dbms'] for b in bugs))"

# 4. å¦‚æœæƒ³è¦æ›´å¤šSQLite/MySQL/PostgreSQLçš„bugs
#    ç›´æ¥ä½¿ç”¨bugs.jsonï¼Œé‡Œé¢å·²ç»æœ‰äº†ï¼
python stats.py  # æŸ¥çœ‹bugs.jsonçš„ç»Ÿè®¡
```

---

**æœ€åæ›´æ–°**: 2025-10-31  
**ç‰ˆæœ¬**: v2.0

